<html><head>
<meta name="viewport" content="width=device-width">
<title>Gemini MIS</title>
<link href="/favicon.ico?v=1.2" rel="shortcut icon" type="image/x-icon">
<link href="/Content/lib/bootstrap.min.css?v=1.0" rel="stylesheet">
<link href="/Content/lib/font-awesome.min.css?v=1.0" rel="stylesheet">
<link href="/Content/lib/login.min.css?v=1.0" rel="stylesheet">
<link href="/Content/lib/main.css?v=1.6" rel="stylesheet">
<link href="/Content/lib/sweetalert.css?v=1.0" rel="stylesheet">
<link href="/Content/lib/sweet-alert-animations.min.css?v=1.0" rel="stylesheet">
<link href="/Content/lib/font-awesome.min.css?v=1.0" rel="stylesheet">
<link href="/Content/app/mis.common.css?v=2.10" rel="stylesheet">
<script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/vP4jQKq0YJFzU6e21-BGy3GP/recaptcha__en.js" crossorigin="anonymous" integrity="sha384-vs3dl3wt0sr1NSmWE/o2E71r7EDd6e3fFXEmu4tyET7uqtZw1URcwd3+DYJQtrMg"></script><script language="javascript" type="text/javascript">
    //if (window.location.hostname !== 'localhost') {
    //    if (window.location.protocol !== 'https:') {
    //        window.location = 'https://' + window.location.hostname + (window.location.port ? ':' + window.location.port : '') + window.location.pathname + window.location.hash;
    //    }
    //}
    </script>
<script src="/Scripts/lib/jquery.min.js" type="text/javascript"></script>
<script src="/Scripts/lib/datatable/vfs_fonts.js" type="text/javascript"></script>
<script async="" src="https://www.google.com/recaptcha/api.js" defer="" type="text/javascript"></script>
<script src="/Scripts/lib/jquery.blockUI.min.js?v=1.0" type="text/javascript"></script>
<script src="/Scripts/common/mis.basepath.js?v=6.3" type="text/javascript"></script>
<script src="/Scripts/common/mis.common.min.js?v=4.7" type="text/javascript"></script>
</head>
<body style="">
<div class="page-center" id="loginContainer">
<div>
<div class="container-fluid">
<style>
    #recaptcha_widget_div {
        overflow: visible;
        transform: scaleX(0.93);
        margin-left: -11px;
    }

    .divider {
        display: flex;
        align-items: center;
        text-align: center;
    }

        /* To show the lines on right
    and left sides of the text */
        .divider::after,
        .divider::before {
            content: "";
            border: 1px solid black;
            flex: 1;
        }

        /* Space on left and right sides of text */
        .divider:not(:empty)::before {
            margin-right: 0.25em;
        }

        .divider:not(:empty)::after {
            margin-left: 0.25em;
        }
</style>
<header style="text-align: center;">
<img width="320" src="/img/GeminiLogo-Small-Black.png">
</header>
<div class="loginMsgDiv">
This website is to be used only for authorized business purposes by the employees of Gemini Solutions.
Unauthorized distribution of any information contained in the website is a violation of Gemini Solutions’ internal policies.
Use of the website is monitored.
If user shares personal data including login credentials with an unauthorized external third party,
they may compromise the user’s confidential information. Gemini Solutions shall have no liability or responsibility for the integrity,
and security of that confidential information.
</div>
<form class="login-form sign-box" novalidate="novalidate">
<div class="sign-avatar">
<img alt="" id="user-avatar" src="http://mymisapi.geminisolutions.com:8700/Images/female-employee.png?v=4.7">
</div>
<header class="sign-title" id="loginTitle">Sign In</header>
<div class="alert alert-danger display-hide">
<button class="close"></button>
<span class="message">
Enter your username and password.
</span>
</div>
<div class="form-group">
<input type="text" class="form-control" placeholder="Username" id="username" name="username">
</div>
<div class="form-group">
<input type="password" autocomplete="off" class="form-control" placeholder="Password" id="password" name="password">
</div>
<div class="form-group">
<div class="float-left">
<a href="javascript:void(0)" id="lnkForgotPassword">Forgot Password?</a>
<a href="javascript:void(0)" id="lnkSignIn" style="display:none;">Sign In</a>
</div>
<div class="float-right reset">
<input type="button" class="btn btn-rounded m-a-0" name="submit" value="Sign in" id="btnLogin" onclick="if (!window.__cfRLUnblockHandlers) return false; userLogin();">
</div>
</div>
</form>
<div class="sign-box" style="padding:5px !important">
<button type="button" class="btn btn-rounded" value="" onclick="if (!window.__cfRLUnblockHandlers) return false; signIn();">Login via SSO</button>
</div>
<script src="/Scripts/app/login/login.js?v=2.5" type="text/javascript"></script>
<script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.12/js/adal.min.js" type="text/javascript"></script>
<script type="text/javascript">
    var ADAL = new AuthenticationContext({
        instance: 'https://login.microsoftonline.com/',
        tenant: 'b9806c7d-9280-4e44-afea-6dc0ff495c2f', //COMMON OR YOUR TENANT ID

        clientId: '07ca69d7-7311-4bb9-a217-be772bb8a4d8', //This is your client ID
        redirectUri: 'https://mymis.geminisolutions.com/Dashboard/Index', //This is your redirect URI

        callback: userSignedIn,
        popUp: true
    });

    function signIn() {
        ADAL.login();
    }

    function userSignedIn(err, token) {
        console.log('userSignedIn called');
        if (!err) {
            //console.log("token: " + token);
            showWelcomeMessage();
        }
        else {
            console.error("error: " + err);
        }
    }

    function showWelcomeMessage() {
        var user = ADAL.getCachedUser();
        //var divWelcome = document.getElementById('WelcomeMessage');
        //  divWelcome = "Welcome " + user.profile.name + " --" + user.userName + "----" + user.profile.unique_name;
        var bInfo = [getBrowserInfo().name, getBrowserInfo().fullVersion].join(' ');
        var cInfo = localStorage.getItem('clientInfo');

        var userDetails = JSON.stringify(user);

        var jsonObject = {
            userName: user.userName,
            browserInfo: bInfo,
            clientInfo: cInfo,
            userD: userDetails
        }

        calltoAjaxAnonymous(misApiUrl.authenticateFromSSO, 'POST', jsonObject,
            function (data, status, xhr) {
                //clear session
                //  misSession.logout();
                if (xhr.status == 200) {
                    //set token
                    misSession.token = data.Token;//xhr.getResponseHeader("Token");
                    sessionStorage['misSession.token'] = misSession.token;

                    misSession.userabrhs = data.UserAbrhs;
                    sessionStorage['misSession.userabrhs'] = misSession.userabrhs;

                    misSession.username = username;
                    sessionStorage['misSession.username'] = misSession.username;

                    //var tokenExpiry = xhr.getResponseHeader('TokenExpiry');
                    //successfn(data);

                    if (data.Token && misSession.userAbrhs) { //&& userAbrhs
                        callToAjaxWithHeader(misApiUrl.userInfo, 'POST', null, { 'Token': data.Token, 'UserAbrhs': misSession.userAbrhs },
                            function (data, status, xhr) {
                                if (xhr.status == 200) {
                                    //Persist user details locally
                                    misSession.userabrhs = data.UserAbrhs;
                                    sessionStorage['misSession.userabrhs'] = misSession.userabrhs;

                                    misSession.username = data.UserName;
                                    sessionStorage['misSession.username'] = misSession.username;

                                    misSession.displayname = data.DisplayName;
                                    sessionStorage['misSession.displayname'] = misSession.displayname;

                                    misSession.userrole = data.Role;
                                    sessionStorage['misSession.userrole'] = misSession.userrole;

                                    misSession.roleid = data.RoleId;
                                    sessionStorage['misSession.roleid'] = misSession.roleid;

                                    misSession.company = data.Company;
                                    sessionStorage['misSession.company'] = misSession.company;

                                    misSession.companyid = data.CompanyId;
                                    sessionStorage['misSession.companyid'] = misSession.companyid;

                                    misSession.companylocation = data.CompanyLocation;
                                    sessionStorage['misSession.companylocation'] = misSession.companylocation;

                                    misSession.companylocationid = data.CompanyLocationId;
                                    sessionStorage['misSession.companylocationid'] = misSession.companylocationid;

                                    misSession.countryid = data.CountryId;
                                    sessionStorage['misSession.countryid'] = misSession.countryid;

                                    misSession.stateid = data.StateId;
                                    sessionStorage['misSession.stateid'] = misSession.stateid;

                                    misSession.cityid = data.CityId;
                                    sessionStorage['misSession.cityid'] = misSession.cityid;

                                    misSession.currentappraisalcycleid = data.CurrentAppraisalCycleId;
                                    sessionStorage['misSession.currentappraisalcycleid'] = misSession.currentappraisalcycleid;

                                    misSession.goalcycleid = data.GoalCycleId;
                                    sessionStorage['misSession.goalcycleid'] = misSession.goalcycleid;

                                    misSession.fystartdate = data.FYStartDate;
                                    sessionStorage['misSession.fystartdate'] = misSession.fystartdate;

                                    misSession.fyenddate = data.FYEndDate;
                                    sessionStorage['misSession.fyenddate'] = misSession.fyenddate;

                                    misSession.fystartyear = data.FYStartYear;
                                    sessionStorage['misSession.fystartyear'] = misSession.fystartyear;

                                    misSession.currentquarter = data.CurrentQuarter;
                                    sessionStorage['misSession.currentquarter'] = misSession.currentquarter;

                                    misSession.imagePath = data.ImagePath;
                                    sessionStorage['misSession.imagePath'] = misSession.imagePath;

 				    misSession.displayname = data.DisplayName;
                                    sessionStorage['misSession.displayname'] = misSession.displayname;

                                    misSession.apiVersion = data.AppVersion;
                                    sessionStorage['misSession.apiVersion'] = misSession.apiVersion;

                                    misSession.menus = data.Menus;
                                    sessionStorage['misSession.menus'] = JSON.stringify(misSession.menus);

                                    redirectToURL(misAppUrl.dashboard);
                                }
                                else {
                                    misAlert(xhr.statusText);
                                    redirectToURL(misAppUrl.login);
                                }
                            });
                    }

                    redirectToURL(misAppUrl.home);
                }
                else {
                    misAlert(xhr.statusText);
                }
            });

        // set_cook(user.profile.name, user.userName, user.profile.unique_name, user.profile.oid);
        //ADAL.logOut();
    }


</script>
</div>
</div>
<div class="text-center" style="margin-top: 15px;">
<p>© 2022 MIS | All Rights Reserved</p>
</div>
</div>



<script src="/Scripts/lib/bootstrap.js" type="text/javascript"></script>
<script src="/Scripts/lib/jquery.matchHeight.min.js" type="text/javascript"></script>
<script src="/Scripts/lib/plugins.js" type="text/javascript"></script>
<script src="/Scripts/lib/jquery.validation.min.js" type="text/javascript"></script>
<script src="/Scripts/lib/jquery.blockUI.min.js" type="text/javascript"></script>
<script src="/Scripts/lib/sweetalert.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        $(document).ajaxStart($.blockUI).ajaxError($.unblockUI).ajaxStop($.unblockUI);
        //$('.page-center').matchHeight({
        //    target: $('html')
        //});

        //$(window).resize(function () {
        //    setTimeout(function () {
        //        $('.page-center').matchHeight({ remove: true });
        //        $('.page-center').matchHeight({
        //            target: $('html')
        //        });
        //    }, 100);
        //});
    });
</script>
<div class="responsive-bootstrap-toolkit"><div class="device-xs visible-xs visible-xs-block"></div><div class="device-sm visible-sm visible-sm-block"></div><div class="device-md visible-md visible-md-block"></div><div class="device-lg visible-lg visible-lg-block"></div></div></body></html>